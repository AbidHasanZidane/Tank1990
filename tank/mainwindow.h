#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include<QMainWindow>
#include<QWidget>
#include<QGraphicsPixmapItem>
#include<QGraphicsView>
#include<QGraphicsScene>
#include<QList>
#include<QTimer>
#include<QtDebug>
#include<QKeyEvent>
#include"mytank.h"
#include"bullet.h"
#include"enemy.h"
#include"building.h"
#include"enemybullet.h"
#include<QFile>
#include<QTextStream>
#include<QFileDialog>
#include"mainwindow2.h"
#include<QPushButton>

namespace Ui {
class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = nullptr);
    ~MainWindow();
    MainWindow2* main2=NULL;
    //按键控制坦克移动和发射子弹
    void keyPressEvent(QKeyEvent* event);

    void keyReleaseEvent(QKeyEvent* event);
    //子弹的移动
    void BulletShoot();
    //子弹射击
    void BulletShoot2();
    //敌人射击
    void EnemyShoot();
    //敌人子弹的移动
    void eBulletShoot();
    //在（x,y）处生成敌人
    void CreatEnemy(int x,int y);
    //敌人死亡
    void EnemyBoom();
    //敌人移动
    void EnemyMove();
    //我方与敌方坦克的碰撞判定
    void myTankCollide1();
    //我方坦克与敌方子弹的碰撞判定及我方的死亡动画
    void myTankCollide2();
    //在（x,y）处创造某种建筑物
    void BuildingCreate(int x,int y,int kind);
    //我方子弹与各类建筑物的碰撞判定
    void BuildingCollide1();
    //我方坦克与各类建筑的碰撞判定
    void BuildingCollide2();
    //敌方坦克与各类建筑的碰撞判定
    void BuildingCollide3();
    //敌方子弹与各类建筑的碰撞判定
    void BuildingCollide4();
    //清除场上所有物品
    void clear();
    //第一关
    void game1();
    //第二关
    void game2();
    //第三关
    void game3();
    //第四关
    void game4();
    //第五关
    void game5();
    //游戏结束
    void GameOver();
private:
    Ui::MainWindow *ui; // UI对象指针

    QGraphicsView mGameView; // 游戏视图对象

    QGraphicsScene mScene; // 游戏场景对象

    QGraphicsPixmapItem mBackGround; // 背景图像对象

    MyTank mTank; // 我方坦克对象

    QTimer* BulletTime; // 子弹计时器

    QTimer* Time; // 计时器1

    QTimer* Time2; // 计时器2

    QTimer* GTime1; // 关卡计时器1

    QTimer* GTime2; // 关卡计时器2

    QTimer* GTime3; // 关卡计时器3

  QTimer* GTime4; // 关卡计时器4

    QList<Bullet*> mBullet; // 子弹列表

    QList<Enemy*> mEnemy; // 敌人列表

    QList<Building*> mBuilding; // 建筑物列表

    QList<enemyBullet*> eBullet; // 敌方子弹列表

    QList<int> BulletMove; // 子弹移动列表

    int dir; // 方向变量

    int killnum; // 击杀数

    int grade; // 分数

    int hp; // 生命值
    //地图二维数组，数字代表建筑种类
    int map1[18][32]={
        {3, 0, 3, 0,	0,	1,	0,	0,	0,	1,	0,	0,	0,	1,	1,	0,	1,	1,	1,1,0,0,1,1,0,0,0,0,0,1,1,1},
        {0, 0, 0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	1,	1,	0,	1,	1,	1,	1,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	1},
        {3, 0, 0,	1,	1,	1,	1,	1,	1,	0,	1,	0,	0,	1,	1,	0,	0,	1,	1,	1,	0,	1,	0,	1,	1,	1,	1,	1,	1,	0,	0,	1},
        {0, 0, 0,	2,	2,	2,	2,	2,	2,	0,	0,	0,	0,	1,	1,	0,	0,	0,	1,	1,	0,	0,	0,	2,	2,	2,	2,	2,	2,	0,	0,	1},
        {0, 0, 0,	0,	0,	0,	0,	4,	0,	0,	0,	0,	0,	1,	1,	0,	0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	0,	4,	0,	0,	0,	1},
        {0, 0, 0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
        {0, 0, 0,	0,	0,	0,	0,	4,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	4,	0,	0,	0,	0},
        {0, 0, 0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
        {0, 0, 0,	0,	0,	0,	0,	4,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	4,	0,	0,	0,	0},
        {0, 0, 0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
        {3, 0, 0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
        {},
        {},
        {},
        {0,0,0,	0,	0,	0,	0,	0,	0,	0,	2,	0,	0,	0,	0,	0,	0,	0,	0,	0,	2,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
        {0,0,0,	0,	0,	0,	0,	0,	0,	0,	0,	2,	2,	2,	2,	2,	2,	2,	2,	2,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
        {0,0,0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
        {0,0,0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0}
    };//地图1
    int map2[18][32]={
       { 0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
       { 0,	0,	0,	0,	0,	0,	0,	2,	2,	2,	2,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
       { 0,	0,	0,	0,	0,	2,	2,	0,	0,	0,	0,	2,	2,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
       { 0,	0,	0,	0,	2,	3,	0,	0,	0,	0,	0,	0,	0,	2,	0,	0,	0,	0,	0,	0,	0,	2,	2,	2,	2,	0,	0,	0,	0,	0,	0,	0},
       { 0,	0,	0,	2,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	2,	0,	0,	0,	0,	2,	2,	0,	0,	0,	0,	2,	2,	0,	0,	0,	0,	0},
       { 0,	0,	0,	2,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	2,	0,	0,	0,	2,	3,	0,	0,	0,	0,	0,	0,	0,	2,	0,	0,	0,	0},
       { 0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	2,	0,	2,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	2,	0,	0,	0},
       { 0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	2,	0,	2,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	2,	0,	0,	0},
       { 0,	0,	1,	1,	0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	1,	3,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0},
       { 0,	0,	1,	1,	1,	1,	4,	0,	1,	0,	0,	0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0},
       { 0,	0,	0,	2,	0,	1,	0,	0,	1,	1,	1,	1,	1,	0,	2,	0,	2,	1,	0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	1,	1,	0,	0},
       { 0,	0,	0,	2,	0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	2,	0,	2,	1,	1,	1,	4,	0,	1,	0,	0,	0,	0,	1,	1,	1,	0,	0},
       { 0,	0,	0,	0,	2,	0,	0,	0,	0,	0,	0,	0,	0,	2,	0,	0,	0,	2,	0,	1,	0,	0,	1,	1,	1,	1,	1,	0,	2,	0,	0,	0},
       { 0,	0,	0,	0,	2,	0,	0,	0,	0,	0,	0,	2,	2,	0,	0,	0,	0,	2,	0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	2,	0,	0,	0},
       { 0,	0,	0,	0,	0,	2,	2,	0,	0,	0,	0,	2,	2,	0,	0,	0,	0,	0,	2,	0,	0,	0,	0,	0,	0,	0,	0,	2,	0,	0,	0,	0},
       { 0,	0,	0,	0,	0,	0,	0,	2,	2,	2,	2,	0,	0,	0,	0,	0,	0,	0,	2,	0,	0,	0,	0,	0,	0,	2,	2,	0,	0,	0,	0,	0},
       { 0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	2,	2,	0,	0,	0,	0,	2,	2,	0,	0,	0,	0,	0},
       { 0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	2,	2,	2,	2,	0,	0,	0,	0,	0,	0,	0}
    };//地图2
    int map3[18][32]{
        {3,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	1,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	3,	0,	0,	0,	0,	0,	1,	2,	1,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	0,	0,	1,	2,	0,	1,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,},
        {3,	0,	3,	0,	3,	0,	0,	1,	2,	0,	1,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	0,	1,	0,	0,	3,	0,	1,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,},
        {0,	0,	3,	0,	0,	0,	1,	2,	0,	0,	0,	1,	0,	0,	0,	0,	1,	0,	0,	0,	0,	2,	1,	0,	0,	0,	1,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	1,	0,	0,	0,	1,	0,	0,	0,	0,	0,	4,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,},
        {3,	0,	3,	0,	3,	0,	0,	1,	1,	0,	1,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	0,	0,	0,	1,	2,	1,	0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,},
        {0,	0,	1,	1,	0,	0,	0,	0,	1,	0,	0,	1,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	1,	1,	0,	0,	0,	0,	1,	1,	0,	0,	2,	1,	0,	0,	0,	2,	1,	0,	1,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	1,	1,	0,	0,	0,	0,	0,	1,	0,	0,	2,	0,	0,	0,	0,	0,	2,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	1,	0,	2,	0,	0,	0,	2,	2,	0,	0,	0,	1,	0,	0,	0,	3,	0,	0,	0,	0,	0,	0,},
        {0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	0,	1,	2,	0,	0,	0,	0,	0,	0,	0,	1,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	1,	1,	0,	0,	0,	0,	0,	1,	1,	1,	0,	3,	0,	3,	0,	3,	0,	0,	0,	0,},
        {0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	1,	0,	1,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	1,	0,	1,	0,	0,	0,	0,	0,	0,	0,	1,	1,	0,	0,	0,	0,	0,},
        {0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	1,	1,	0,	0,	0,	0,	0,}

    };//地图3
    int map4[18][32]{
        {0,	0,	0,	4,	0,	0,	0,	0,	1,	1,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	1,	1,	0,	0,	4,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	0,	4,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	1,	1,	0,	0,	0,	0,	1,	0,	0,	0,	0,	1,	4,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	1,	0,	1,	1,	0,	1,	0,	0,	0,	1,	0,	1,	0,	0,	0,	0,	0,	0,},
        {0,	0,	0,	4,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	1,	0,	0,	0,	1,	0,	0,	1,	4,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	1,	0,	0,	0,	0,	1,	2,	0,	0,	0,	1,	0,	0,	0,	1,	0,	0,	1,	0,	1,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	0,	4,	0,	1,	0,	0,	0,	0,	2,	2,	0,	0,	0,	1,	0,	0,	0,	1,	0,	0,	1,	1,	0,	0,	4,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	2,	1,	0,	0,	1,	0,	0,	0,	0,	0,	1,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	0,	4,	0,	0,	0,	1,	1,	0,	0,	0,	0,	1,	0,	1,	0,	0,	0,	0,	1,	0,	1,	0,	0,	0,	4,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	0,	0,	1,	0,	1,	1,	1,	0,	0,	1,	0,	1,	0,	0,	0,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	0,	4,	0,	0,	0,	0,	1,	1,	0,	0,	0,	1,	0,	0,	0,	1,	0,	0,	1,	0,	0,	0,	0,	0,	4,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	1,	0,	0,	0,	1,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	0,	4,	0,	0,	0,	0,	0,	1,	0,	1,	0,	0,	1,	0,	1,	1,	0,	1,	0,	0,	0,	0,	0,	0,	4,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	1,	0,	0,	1,	1,	0,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	0,	4,	0,	0,	0,	0,	0,	0,	1,	1,	0,	1,	1,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	4,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,},
        {0,	0,	0,	4,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	4,	0,	0,	0,	0,	0,},
        {0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,}

    };//地图4
    int map5[18][32]{
        {3,	0,	3,	0,	3,	0,	3,	0,	3,	0,	3,	0,	3,	0,	3,	0,	3,	0,	0,	0,	0,	3,	0,	3,	3,	0,	3,	0,	3,	0,	3,	0,},
        {0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	3,	3,	0,	0,	1,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,},
        {3,	0,	3,	0,	3,	0,	3,	0,	3,	0,	3,	0,	3,	3,	0,	0,	0,	1,	3,	3,	0,	1,	3,	0,	3,	0,	3,	0,	3,	0,	3,	0,},
        {0,	0,	0,	0,	0,	0,	0,	0,	3,	0,	0,	3,	0,	0,	0,	1,	1,	1,	0,	0,	0,	1,	0,	0,	3,	0,	0,	0,	0,	0,	0,	0,},
        {3,	0,	3,	0,	3,	0,	3,	3,	0,	0,	3,	0,	0,	1,	1,	0,	1,	0,	1,	0,	1,	0,	1,	1,	0,	3,	3,	0,	3,	0,	3,	0,},
        {0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	0,	0,	1,	0,	0,	1,	3,	0,	1,	0,	1,	0,	3,	0,	1,	0,	0,	0,	0,	0,	0,	0,},
        {3,	0,	3,	0,	3,	0,	3,	0,	1,	0,	1,	1,	1,	0,	1,	3,	0,	0,	1,	3,	0,	1,	0,	3,	0,	1,	3,	0,	3,	0,	3,	0,},
        {0,	0,	0,	0,	0,	0,	3,	0,	1,	3,	0,	3,	0,	1,	1,	0,	0,	1,	3,	0,	3,	0,	1,	3,	0,	1,	0,	0,	0,	0,	0,	0,},
        {3,	0,	3,	0,	3,	3,	0,	0,	1,	0,	0,	0,	0,	3,	0,	1,	0,	1,	0,	0,	0,	0,	1,	0,	0,	1,	3,	0,	3,	0,	3,	0,},
        {0,	0,	0,	0,	0,	0,	0,	1,	3,	0,	3,	0,	3,	0,	3,	0,	1,	1,	1,	3,	0,	0,	1,	0,	1,	0,	0,	0,	0,	0,	0,	0,},
        {3,	0,	3,	0,	3,	0,	1,	1,	0,	0,	0,	0,	0,	3,	0,	3,	0,	0,	1,	0,	0,	1,	1,	1,	0,	1,	3,	0,	3,	0,	3,	0,},
        {0,	0,	0,	0,	0,	0,	1,	1,	3,	0,	3,	3,	0,	0,	0,	0,	0,	1,	0,	1,	1,	1,	0,	3,	0,	1,	0,	0,	0,	0,	0,	0,},
        {3,	0,	3,	0,	3,	0,	1,	3,	0,	3,	3,	0,	0,	1,	1,	3,	3,	0,	0,	0,	0,	0,	1,	0,	0,	1,	3,	0,	3,	0,	3,	0,},
        {0,	0,	0,	0,	0,	0,	1,	0,	3,	0,	3,	0,	1,	0,	2,	3,	0,	0,	1,	0,	1,	0,	1,	1,	1,	3,	0,	0,	0,	0,	0,	0,},
        {3,	0,	3,	0,	3,	3,	0,	1,	0,	0,	3,	0,	1,	2,	2,	0,	0,	1,	3,	3,	0,	1,	3,	0,	3,	0,	3,	0,	3,	0,	3,	0,},
        {0,	0,	0,	0,	0,	0,	3,	0,	1,	1,	0,	0,	0,	0,	0,	0,	1,	0,	3,	3,	0,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,},
        {3,	0,	3,	0,	3,	0,	3,	0,	3,	0,	1,	1,	1,	1,	1,	1,	1,	1,	0,	0,	0,	1,	3,	0,	3,	0,	3,	0,	3,	0,	3,	0,},
        {0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	1,	1,	1,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,}

    };//地图5
};


#endif // MAINWINDOW_H

